!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([,function(t,e,n){"use strict";n.r(e);class o{constructor(t,e,n,o,i){this._f=t,this._l=this,this._r=null,this._c=null,this._t=e,this._k=0,this._p=n,this._i=null,this._cs=o,this._s=i,this._e=null}k(t){return this._f|=128,this._k=t,this}e(t){return null!==t&&(this._f|=512,this._e=t),this}t(t){return this._f|=-2147483584,this._c=t,this}c(){const t=arguments;let e=null,n=null;for(let i=0,r=0;i<t.length;++i,++r){let s=t[i];if(null!==s){"object"!==typeof s&&(s=new o(1,null,s,"",void 0));const t=s._l,i=s._f;if(t===s)0===(128&i)&&(s._k=r);else if(0===(256&i)){let t=s;do{0===(128&t._f)&&(t._k=r),++r,t=t._r}while(null!==t);--r}null!==n?(s._l=n,n._r=s):e=s,n=t}}return null!==e&&(e._l=n,this._f|=32,this._c=e),this}}function i(t){return 0!==(6168&t._f)?i(t._c):t._i}(()=>{let t=!1;try{const n=Object.defineProperty({},"passive",{get(){t=!0}});window.addEventListener("test",null,n)}catch(e){}})(),KeyboardEvent.prototype.hasOwnProperty("key"),MouseEvent.prototype.hasOwnProperty("buttons"),window,window,window;const r="GestureEvent"in window;function s(){}function l(t,e){const n=t.length-1,o=t.pop();e!==n&&(t[e]=o)}const c=[];function f(t){return(...e)=>{try{return t(...e)}catch(n){for(const t of c)t(n);throw n}}}const u=Node.prototype,a=Element.prototype,d=(Object.prototype.hasOwnProperty,u.insertBefore),h=u.removeChild,_=u.replaceChild,p=u.cloneNode,g=a.setAttribute,v=(a.setAttributeNS,a.removeAttribute),y="http://www.w3.org/2000/svg";function w(t,e){let n,o,i;if(null===t)m(e);else if(null===e)b(t);else if(t instanceof Array)if(e instanceof Array){for(n=0;n<t.length&&n<e.length;)(o=t[n])!==(i=e[n++])&&(null!==i&&k(i),null!==o&&x(o));for(;n<e.length;)null!==(o=e[n++])&&k(o);for(;n<t.length;)null!==(o=t[n++])&&x(o)}else for(k(e),n=0;n<t.length;++n)null!==(o=t[n])&&x(o);else m(e),x(t)}function m(t){if(t instanceof Array)for(let e=0;e<t.length;++e){const n=t[e];null!==n&&k(n)}else k(t)}function b(t){if(t instanceof Array)for(let e=0;e<t.length;++e){const n=t[e];null!==n&&x(n)}else x(t)}function k(t){t.src.add(t)}function x(t){t.src.remove(t)}function O(t,e){h.call(t,i(e)),j(e)}function A(t){const e=t._f;if(0!==(6200&e)){0!==(16&e)&&t._i.attached();let n=t._c;for(;null!==n;)A(n),n=n._r}0!==(512&e)&&m(t._e)}function j(t){const e=t._f;if(0!==(6200&e)){let n=t._c;for(;null!==n;)j(n),n=n._r;if(0!==(16&e)){const e=t._i;e.flags|=1,e.detached()}}0!==(512&e)&&b(t._e)}function D(t,e,n,o){const i=e._f;let r,s;if((-2147477448&i)>0)if(r=e._c,0!==(32&i))for(s=e._i;null!==r;)D(s,r,n,o),r=r._r;else if(0!==(16&i))0!==(2&(s=e._i).flags)?(E(t,r,e._c=s.render(),n,o),s.flags&=-3,s.updated()):D(t,r,n,o);else if(0!==(2048&i)){const i=e._t;s=e._i;const l=i.select(s,e._p,n);s===l?D(t,r,n,o):(e._i=l,E(t,r,e._c=i.render(l),n,o))}else 0!==(4096&i)&&(!0===o&&(e._i=Object.assign({},n,e._p)),n=e._i),D(t,r,n,o)}function C(t,e){t.textContent="";do{j(e),e=e._r}while(null!==e)}function N(t,e,n){const o=e._f,i=e._p;let r,s=null;if(0!==(1&o))s=r=document.createTextNode(i);else{const l=e._t;if(0!==(18&o))if(0!==(2&o)){const c=0!==(1024&o);0===(4&o)?r=c?document.createElementNS(y,l):document.createElement(l):(null===l._i&&N(t,l,n),r=p.call(l._i,!0)),s=r;const f=e._cs;if(f&&(!0===c?g.call(r,"class",f):r.className=f),void 0!==i&&B(r,void 0,i),void 0!==e._s&&M(r,void 0,e._s),0!==(32&o)){let t=e._c;for(;null!==t;)d.call(r,N(r,t,n),null),t=t._r}else 0!==(64&o)&&""!==e._c&&(r.textContent=e._c)}else s=new l(i),r=N(t,e._c=s.render(),n);else{if(0!==(6144&o))if(0!==(2048&o)){const t=l;s=t.select(null,i,n),e._c=t.render(s)}else n=s=Object.assign({},n,i);else e._c=l.render(i);r=N(t,e._c,n)}}return e._i=s,r}function P(t,e,n,o){const i=N(t,n,o);return d.call(t,i,e),A(n),i}function E(t,e,n,o,r){if(e===n)return void D(t,n,o,r);let s;const l=e._f,c=n._f;if(0!==(4185311&(l^c))||0!==(2076&l)&&e._t!==n._t||e._k!==n._k)s=N(t,n,o),_.call(t,s,i(e)),j(e),A(n);else{const i=e._p,f=n._p;if(n._i=s=e._i,0!==(1&c))i!==f&&(s.data=f);else{const u=e._c;let a=n._c;if(e._e!==n._e&&w(e._e,n._e),0!==(18&c))if(0!==(2&c)){let t=n._cs;if(e._cs!==t&&(void 0===t&&(t=""),0!==(1024&c)?g.call(s,"class",t):s.className=t),i!==f&&B(s,i,f),e._s!==n._s&&M(s,e._s,n._s),u!==a)if(0===(64&l))if(null===u)do{P(s,null,a,o),a=a._r}while(null!==a);else null===a?C(s,u):S(s,u,a,o,r);else{const t=s.firstChild;null!==t?t.nodeValue=a:s.textContent=a}}else i!==f&&s.propsChanged(i,f),s.props=f,0!==(2&s.flags)||!0===s.shouldUpdate(i,f)?(E(t,u,n._c=s.render(),o,r),s.flags&=-3,s.updated()):D(t,n._c=u,o,r);else if(0!==(6144&c))if(0!==(2048&c)){const e=n._t,i=n._i=e.select(s,f,o);s===i?D(t,n._c=u,o,r):E(t,u,n._c=e.render(i),o,r)}else i!==f&&(r=!0),n._i=o=!0===r?Object.assign({},o,f):s,E(t,u,a,o,r);else{const e=n._t;i===f||0!==(8192&c)&&!0!==e.shouldUpdate(i,f)?D(t,n._c=u,o,r):E(t,u,n._c=e.render(f),o,r)}}}}function S(t,e,n,o,r){let s=e._l,l=n._l,c=0,f=0;t:for(;;){for(;e._k===n._k&&0===(128&(e._f^n._f));){if(E(t,e,n,o,r),f++,e===s?c=1:e=e._r,n===l){c|=2;break t}if(n=n._r,c)break t}for(;s._k===l._k&&0===(128&(s._f^l._f));){if(E(t,s,l,o,r),f++,e===s?c=1:s=s._l,n===l){c|=2;break t}if(l=l._l,c)break t}break}if(c){if(c<3)if(c<2){const e=T(l);for(;P(t,e,n,o),n!==l;)n=n._r}else for(;O(t,e),e!==s;)e=e._r}else{let u=0,a=0,h=0;const _=[];let p,g,v,y=n;for(;v=y._k,128&y._f?(void 0===p&&(p=new Map),p.set(v,a)):(void 0===g&&(g=new Map),g.set(v,a)),_[a++]=y,y!==l;)y=y._r;const w=new Array(a).fill(-1);let m=0;for(y=e;v=y._k,void 0===(c=0!==(128&y._f)?void 0===p?void 0:p.get(v):void 0===g?void 0:g.get(v))?y._k=null:(h=h>c?1e9:c,w[c]=u,E(t,y,_[c],o,r),m++),u++,y!==s;)y=y._r;if(f||m){for(c=u-m;c>0;)null===e._k&&(O(t,e),c--),e=e._r;if(1e9===h){const e=I(w);for(c=e.length-1;a>0;)w[--a]<0?P(t,T(l),l,o):c<0||a!==e[c]?d.call(t,i(l),T(l)):c--,l=l._l}else if(m!==a)for(;a>0;)w[--a]<0&&P(t,T(l),l,o),l=l._l}else{C(t,e);do{P(t,null,n,o),n=n._r}while(null!==n)}}}function T(t){const e=t._r;return null===e?null:i(e)}function I(t){const e=t.slice(),n=[];n[0]=0;let o,i,r,s=0;for(let l=0;l<t.length;++l){const c=t[l];if(-1!==c)if(t[r=n[s]]<c)e[l]=r,n[++s]=l;else{for(o=0,i=s;o<i;)t[n[r=(o+i)/2|0]]<c?o=r+1:i=r;c<t[n[o]]&&(o>0&&(e[l]=n[o-1]),n[o]=l)}}for(i=n[s];s>=0;)n[s--]=i,i=e[i];return n}function M(t,e,n){const o=t.style;let i,r;if(void 0===e)for(i in n)void 0!==(r=n[i])&&o.setProperty(i,r);else if(void 0!==n)for(i in n)r=n[i],e[i]!==r&&(void 0!==r?o.setProperty(i,r):o.removeProperty(i))}function F(t,e,n,o){n!==o&&("object"===typeof o?o.s(t,e,void 0===n?void 0:n.v,o.v):("boolean"===typeof o&&(o=o?"":void 0),void 0===o?v.call(t,e):g.call(t,e,o)))}function B(t,e,n){let o;if(void 0===e)for(o in n)F(t,o,void 0,n[o]);else if(void 0!==n)for(o in n)F(t,o,e[o],n[o])}const G=[];function K(t){for(const e of G)if(e.container===t)return e}let L;const R={};let U=0;function $(t){L(t)}function q(){for(let t=0;t<G.length;++t){const e=G[t],{container:n,current:o,next:i}=e;e.next=void 0,i?(o?E(n,o,i,R,!1):(P(n,null,i,R),r&&(n.onclick=s)),e.current=i):o&&(null===i?(O(n,o),l(G,G.indexOf(e)),--t):D(n,o,R,!1))}}function H(t,e,n){const o=K(e);o?o.next=t:G.push({container:e,next:t,current:null}),$(n)}function V(t,e,n){for(const{container:o,current:i}of G)if(o.contains(e)){z(t,n,e,o,i);break}}function z(t,e,n,o,i){const r=n.parentNode;if(r!==o){if(null!==(i=z(t,e,r,o,i))&&0!==(6200&i._f)){let o=i._c;for(;null!==o;){const i=J(t,e,n,o);if(i)return i;o=o._r}}return null}return J(t,e,n,i)}function J(t,e,n,o){const i=o._f;let r;if(2&i){if(o._i===n)return Q(t,o,e),o}else if(6168&i&&(r=J(t,e,n,o._c)))return Q(t,o,e),r;return null}function Q(t,e,n){const o=e._e;if(o){let i;if(o instanceof Array){let t=0;for(const e of o)null!==e&&!0===n(e)&&(0===t?i=e:1===t?i=[i,e]:i.push(e),++t)}else!0===n(o)&&(i=o);void 0!==i&&t.push({target:e,handlers:i})}}function W(t,e,n,o){let i=t.length;for(;--i>=0;)if(X(t[i],e,1,o),2&e.flags)return;if(n)for(;++i<t.length;)if(X(t[i],e,2,o),2&e.flags)return}function X(t,e,n,o){const i=t.handlers;let r=0;if(i instanceof Array)for(const s of i)s.flags&n&&(r|=Y(s,o,e));else i.flags&n&&(r=Y(i,o,e));e.flags|=r}function Y(t,e,n){const o=void 0===e?t.handler(n):e(t,n);return void 0===o?0:o}f(()=>{for(U|=2;2===U;)U>>=1,q(),U^=1});class Z{constructor(t,e){this.flags=t,this.timestamp=e}}class tt extends Z{constructor(t,e,n,o){super(t,n),this.target=e,this.native=o}}function et(t,e,n){const o={src:{add(){++o.listeners,nt(o)},remove(){--o.listeners,ot(o)}},deps:0,listeners:0,flags:t,options:void 0===n||n,name:e,before:null,after:null,dispatch:null},i=t=>t.src===o.src;return o.dispatch=f(t=>{const e=t.target,n=[];if(o.listeners&&V(n,e,i),n.length||o.before||o.after){const i=new tt(0,e,t.timeStamp,t);it(o.before,i),n.length&&W(n,i,0!==(4&o.flags)),it(o.after,i),1&i.flags&&t.preventDefault()}}),o}function nt(t){0===t.deps++&&document.addEventListener(t.name,t.dispatch,t.options)}function ot(t){0===--t.deps&&document.removeEventListener(t.name,t.dispatch,t.options)}function it(t,e){if(t){const n=t.slice();for(const t of n)t(e)}}const rt=et(5,"keydown");function st(t,e,n){return{src:t,flags:!0===n?1:2,handler:e,listeners:0,props:null,state:null}}function lt(t,e=!1){return st(rt.src,t,e)}function ct(t,e){let n=null,o=null;for(let i=0;i<t.length;++i){const r=e(t[i],i);null!==r&&(null!==o?(r._l=o,o._r=r):n=r,o=r)}return null!==n?(n._l=o,n._f|=256,n):null}function ft(t){for(let e=0;e<t.length;++e)!0===t[e]()&&l(t,e--)}function ut(t){const e=t.a;t.a=[];for(const n of e)n()}let at=0;const dt={a:[]},ht=[],_t=[];let pt={f:0,w:{a:[]},r:{a:[]}},gt={f:0,w:{a:[]},r:{a:[]}},vt=0,yt=null;const wt=f(()=>{for(;dt.a.length>0;)ut(dt);at^=1});function mt(){4&at&&requestAnimationFrame(bt)}const bt=f(t=>{at^=12,vt=t;const e=gt;gt=pt,pt=e,ft(ht);do{for(;4&e.f;)e.f^=4,ut(e.r);for(;3&e.f;)2&e.f&&(e.f^=2,ut(e.w)),1&e.f&&(e.f^=1,q())}while(7&e.f);at^=8,ft(_t),null!==yt&&(yt.focus(),yt=null)});const kt={v:!0,s:function(t,e,n,o){var i;void 0===n&&o&&(i=t)instanceof Element&&(yt=i)}};function xt(t,e,n){return new o(376834,"div",e,t,n)}const Ot={x:-1,y:0},At={x:1,y:0},jt={x:0,y:-1},Dt={x:0,y:1};class Ct{constructor(t={x:0,y:0}){this.body=[],this.grow=4,this.body.push(t)}get head(){return this.body[this.body.length-1]}move(t){if(this.body.push(t),this.grow)return this.grow--,null;{const t=this.body[0];return this.body=this.body.splice(1),t}}}class Nt{constructor(t=20,e=20){this.rows=t,this.cols=e,this.cells=new Array(t*e).fill(0)}pointToIndex(t){return this.cols*t.y+t.x}mark(t,e){this.cells[this.pointToIndex(t)]|=e}unmark(t,e){this.cells[this.pointToIndex(t)]&=~e}createRandomFood(){let t=0;do{t=Math.random()*this.cells.length|0}while(0!==this.cells[t]);this.cells[t]|=4}isBodyAt(t){return!!(1&this.cells[this.pointToIndex(t)])}isHeadAt(t){return!!(2&this.cells[this.pointToIndex(t)])}isFoodAt(t){return!!(4&this.cells[this.pointToIndex(t)])}}function Pt(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Et(t,e){return(t%e+e)%e}function St(t){return 1&t?2&t?"Cell body head":"Cell body":4&t?"Cell food":"Cell"}const Tt=(It=class extends class{constructor(t){this.flags=0,this.props=t}propsChanged(t,e){}attached(){}detached(){}shouldUpdate(t,e){return t!==e}updated(){}invalidated(){}invalidate(t){this.flags|=2,this.invalidated(),$(t)}}{constructor(){super(...arguments),this.onKeyDown=lt(t=>{switch(t.native.keyCode){case 37:return this.props.value.setNewDirection(Ot),1;case 38:return this.props.value.setNewDirection(jt),1;case 39:return this.props.value.setNewDirection(At),1;case 40:return this.props.value.setNewDirection(Dt),1}})}render(){const{grid:t}=this.props.value;let e=0;return xt(this.props.value.gameOver?"SnakeGame gameOver":"SnakeGame").c(xt("Grid",{tabIndex:0,autofocus:kt},{width:`${30*t.cols}px`,height:`${30*t.rows}px`}).e(this.onKeyDown).c(ct(t.cells,t=>xt(St(t)).k(e++))))}},t=>new o(16,It,t,"",void 0));var It;const Mt=document.getElementById("app"),Ft=new class{constructor(){this.gameOver=!1,this.startTime=0,this.currentTime=0,this.direction={x:1,y:0},this.grid=new Nt,this.snake=new Ct,this.newDirection=null,this.snake.body.forEach(t=>{this.grid.mark(t,1)}),this.grid.mark(this.snake.head,2),this.grid.createRandomFood()}setNewDirection(t){this.newDirection=t}updateState(){if(!this.gameOver){this.newDirection&&(e={x:0,y:0},((t=Pt(this.direction,this.newDirection)).x!==e.x||t.y!==e.y)&&(this.direction=this.newDirection),this.newDirection=null);let n=Pt(this.snake.head,this.direction);n={x:Et(n.x,this.grid.cols),y:Et(n.y,this.grid.rows)},this.grid.unmark(this.snake.head,2);const o=this.snake.move(n);o&&this.grid.unmark(o,1),this.grid.mark(n,2),this.grid.isBodyAt(n)?this.gameOver=!0:this.grid.isFoodAt(n)&&(this.snake.grow=3,this.grid.unmark(n,4),this.grid.createRandomFood()),this.grid.mark(n,1)}var t,e}};L=function(t){var e;8&at?pt.f|=1:(gt.f|=1,void 0!==t&&1&t?bt(performance.now()):4&at||(e=mt,1&(at|=4)||(at|=1,Promise.resolve().then(wt)),dt.a.push(e)))},function t(){Ft.updateState(),H(Tt({value:Ft}),Mt),setTimeout(t,100)}()}]);